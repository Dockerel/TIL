<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>2. 네임스페이스, 컨피그맵, 시크릿, 인그레스 | Today Dockerel Learned</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/TIL/logo.png">
    <meta name="description" content="Dockerel&#39;s Personal Wiki (Today I Learned)">
    
    <link rel="preload" href="/TIL/assets/css/0.styles.40dd5a95.css" as="style"><link rel="preload" href="/TIL/assets/js/app.0dbe4d60.js" as="script"><link rel="preload" href="/TIL/assets/js/2.188c950f.js" as="script"><link rel="preload" href="/TIL/assets/js/1.a1e51968.js" as="script"><link rel="preload" href="/TIL/assets/js/65.cce0c2b8.js" as="script"><link rel="prefetch" href="/TIL/assets/js/10.e6f03b60.js"><link rel="prefetch" href="/TIL/assets/js/11.0fba4bf3.js"><link rel="prefetch" href="/TIL/assets/js/12.181bd7bc.js"><link rel="prefetch" href="/TIL/assets/js/13.c5707e1c.js"><link rel="prefetch" href="/TIL/assets/js/14.b086a433.js"><link rel="prefetch" href="/TIL/assets/js/15.3e75d743.js"><link rel="prefetch" href="/TIL/assets/js/16.a2bc07a8.js"><link rel="prefetch" href="/TIL/assets/js/17.cdeb945d.js"><link rel="prefetch" href="/TIL/assets/js/18.c240daa0.js"><link rel="prefetch" href="/TIL/assets/js/19.60958448.js"><link rel="prefetch" href="/TIL/assets/js/20.4352d5d9.js"><link rel="prefetch" href="/TIL/assets/js/21.95bf5e05.js"><link rel="prefetch" href="/TIL/assets/js/22.664a6cc8.js"><link rel="prefetch" href="/TIL/assets/js/23.5ae71a00.js"><link rel="prefetch" href="/TIL/assets/js/24.df2a0383.js"><link rel="prefetch" href="/TIL/assets/js/25.1aeaac43.js"><link rel="prefetch" href="/TIL/assets/js/26.eb265b20.js"><link rel="prefetch" href="/TIL/assets/js/27.41f28bb0.js"><link rel="prefetch" href="/TIL/assets/js/28.37ba8758.js"><link rel="prefetch" href="/TIL/assets/js/29.69de06de.js"><link rel="prefetch" href="/TIL/assets/js/3.e9de9cb1.js"><link rel="prefetch" href="/TIL/assets/js/30.34ac9ba8.js"><link rel="prefetch" href="/TIL/assets/js/31.031dd879.js"><link rel="prefetch" href="/TIL/assets/js/32.474f9200.js"><link rel="prefetch" href="/TIL/assets/js/33.4c3a3b6d.js"><link rel="prefetch" href="/TIL/assets/js/34.b322d741.js"><link rel="prefetch" href="/TIL/assets/js/35.8ed0e5c2.js"><link rel="prefetch" href="/TIL/assets/js/36.754edecd.js"><link rel="prefetch" href="/TIL/assets/js/37.c5d4e557.js"><link rel="prefetch" href="/TIL/assets/js/38.8befc973.js"><link rel="prefetch" href="/TIL/assets/js/39.aff5d346.js"><link rel="prefetch" href="/TIL/assets/js/4.c5b6f970.js"><link rel="prefetch" href="/TIL/assets/js/40.e6043a49.js"><link rel="prefetch" href="/TIL/assets/js/41.7d0a7554.js"><link rel="prefetch" href="/TIL/assets/js/42.9afe14b6.js"><link rel="prefetch" href="/TIL/assets/js/43.796fc4b6.js"><link rel="prefetch" href="/TIL/assets/js/44.8bdf66dc.js"><link rel="prefetch" href="/TIL/assets/js/45.58ed5864.js"><link rel="prefetch" href="/TIL/assets/js/46.8e710158.js"><link rel="prefetch" href="/TIL/assets/js/47.1f1bd163.js"><link rel="prefetch" href="/TIL/assets/js/48.0d47fde5.js"><link rel="prefetch" href="/TIL/assets/js/49.2af34ed6.js"><link rel="prefetch" href="/TIL/assets/js/5.5e20f558.js"><link rel="prefetch" href="/TIL/assets/js/50.1f975408.js"><link rel="prefetch" href="/TIL/assets/js/51.c7dc238d.js"><link rel="prefetch" href="/TIL/assets/js/52.d7e88570.js"><link rel="prefetch" href="/TIL/assets/js/53.d14b7aec.js"><link rel="prefetch" href="/TIL/assets/js/54.378d3bf4.js"><link rel="prefetch" href="/TIL/assets/js/55.e25e9470.js"><link rel="prefetch" href="/TIL/assets/js/56.31674b5b.js"><link rel="prefetch" href="/TIL/assets/js/57.3b7e2dfb.js"><link rel="prefetch" href="/TIL/assets/js/58.5f793993.js"><link rel="prefetch" href="/TIL/assets/js/59.96b8576d.js"><link rel="prefetch" href="/TIL/assets/js/6.e8a6e3a8.js"><link rel="prefetch" href="/TIL/assets/js/60.cd2bec61.js"><link rel="prefetch" href="/TIL/assets/js/61.a96c05a5.js"><link rel="prefetch" href="/TIL/assets/js/62.e097350c.js"><link rel="prefetch" href="/TIL/assets/js/63.6845d699.js"><link rel="prefetch" href="/TIL/assets/js/64.c8934f45.js"><link rel="prefetch" href="/TIL/assets/js/66.7c616de9.js"><link rel="prefetch" href="/TIL/assets/js/67.7bfe15fc.js"><link rel="prefetch" href="/TIL/assets/js/68.c5e5e480.js"><link rel="prefetch" href="/TIL/assets/js/69.ee77e917.js"><link rel="prefetch" href="/TIL/assets/js/7.7fea5211.js"><link rel="prefetch" href="/TIL/assets/js/70.b9555da5.js"><link rel="prefetch" href="/TIL/assets/js/71.bed4b1e7.js"><link rel="prefetch" href="/TIL/assets/js/72.b6a8e4d4.js"><link rel="prefetch" href="/TIL/assets/js/vendors~docsearch.68e379d9.js">
    <link rel="stylesheet" href="/TIL/assets/css/0.styles.40dd5a95.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/TIL/" class="home-link router-link-active"><!----> <span class="site-name">Today Dockerel Learned</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/Dockerel/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://dockerel.tistory.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/Dockerel/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://dockerel.tistory.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Backend</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>DomainDrivenArchitecture</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>OperatingSystem</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>PS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Kubernetes</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TIL/Kubernetes/1.-포드,-레플리카-셋,-디플로이먼트,-서비스.html" class="sidebar-link">1.포드, 레플리카 셋, 디플로이먼트, 서비스</a></li><li><a href="/TIL/Kubernetes/2.-네임스페이스,-컨피그맵,-시크릿,-인그레스.html" class="active sidebar-link">2. 네임스페이스, 컨피그맵, 시크릿, 인그레스</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/TIL/Kubernetes/2.-네임스페이스,-컨피그맵,-시크릿,-인그레스.html#namespace-vs-label" class="sidebar-link">namespace vs label</a></li><li class="sidebar-sub-header"><a href="/TIL/Kubernetes/2.-네임스페이스,-컨피그맵,-시크릿,-인그레스.html#네임스페이스-생성" class="sidebar-link">네임스페이스 생성</a></li><li class="sidebar-sub-header"><a href="/TIL/Kubernetes/2.-네임스페이스,-컨피그맵,-시크릿,-인그레스.html#네임스페이스-서비스-접근" class="sidebar-link">네임스페이스 서비스 접근</a></li><li class="sidebar-sub-header"><a href="/TIL/Kubernetes/2.-네임스페이스,-컨피그맵,-시크릿,-인그레스.html#네임스페이스-삭제" class="sidebar-link">네임스페이스 삭제</a></li><li class="sidebar-sub-header"><a href="/TIL/Kubernetes/2.-네임스페이스,-컨피그맵,-시크릿,-인그레스.html#네임스페이스에-종속되는-오브젝트" class="sidebar-link">네임스페이스에 종속되는 오브젝트</a></li><li class="sidebar-sub-header"><a href="/TIL/Kubernetes/2.-네임스페이스,-컨피그맵,-시크릿,-인그레스.html#컨피그맵" class="sidebar-link">컨피그맵</a></li><li class="sidebar-sub-header"><a href="/TIL/Kubernetes/2.-네임스페이스,-컨피그맵,-시크릿,-인그레스.html#시크릿" class="sidebar-link">시크릿</a></li><li class="sidebar-sub-header"><a href="/TIL/Kubernetes/2.-네임스페이스,-컨피그맵,-시크릿,-인그레스.html#인그레스-사용하는-이유" class="sidebar-link">인그레스 사용하는 이유</a></li><li class="sidebar-sub-header"><a href="/TIL/Kubernetes/2.-네임스페이스,-컨피그맵,-시크릿,-인그레스.html#인그레스-생성" class="sidebar-link">인그레스 생성</a></li><li class="sidebar-sub-header"><a href="/TIL/Kubernetes/2.-네임스페이스,-컨피그맵,-시크릿,-인그레스.html#ingress-controller" class="sidebar-link">Ingress Controller</a></li><li class="sidebar-sub-header"><a href="/TIL/Kubernetes/2.-네임스페이스,-컨피그맵,-시크릿,-인그레스.html#인그레스-세부-기능-annotation" class="sidebar-link">인그레스 세부 기능 - annotation</a></li></ul></li><li><a href="/TIL/Kubernetes/3.-pv와-pvc.html" class="sidebar-link">3. PV와 PVC</a></li><li><a href="/TIL/Kubernetes/4.-ServiceAccount와-RBAC.html" class="sidebar-link">4. ServiceAccount와 RBAC</a></li><li><a href="/TIL/Kubernetes/5.-커스텀-리소스,-컨트롤러,-잡,-데몬셋,-스테이트풀셋.html" class="sidebar-link">5. 커스텀 리소스, 컨트롤러, 잡, 데몬셋, 스테이트풀셋</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_2-네임스페이스-컨피그맵-시크릿-인그레스"><a href="#_2-네임스페이스-컨피그맵-시크릿-인그레스" class="header-anchor">#</a> 2. 네임스페이스, 컨피그맵, 시크릿, 인그레스</h1> <h1 id="namespace"><a href="#namespace" class="header-anchor">#</a> namespace</h1> <ul><li>리소스들을 구분 지어 관리할 수 있는 논리적인 그룹 → namespace라는 <strong>오브젝트</strong> 제공</li> <li>쿠버네티스 리소스들이 묶여 있는 하나의 가상 공간 / 그룹</li> <li><code>kubectl get namespaces</code>, <code>kubectl get ns</code> 로 확인 가능</li> <li><code>kubectl get pods --namespace default</code> : --namespace or -n 옵션으로 특정 네임스페이스에 생성된 리소스 확인 가능
<ul><li>default는 기본적으로 쿠버네티스 리소스가 생성되는 네임스페이스</li></ul></li></ul> <h2 id="namespace-vs-label"><a href="#namespace-vs-label" class="header-anchor">#</a> namespace vs label</h2> <ul><li>라벨의 경우 <code>kubectl get pods -l app=webserver</code> 이런식으로 검색 가능</li> <li>네임스페이스는 라벨보다 더 넓은 용도로 사용 가능
<ul><li>특정 네임스페이스에서 생성되는 포드의 자원 사용량 제한</li> <li>특정 네임스페이스에서 생성되는 포드에는 항상 사이드카 컨테이너가 붙도록 설정 가능</li> <li>사용 목적에 따라 리소스를 격리함으로써 편리하게 구분 가능</li></ul></li></ul> <h2 id="네임스페이스-생성"><a href="#네임스페이스-생성" class="header-anchor">#</a> 네임스페이스 생성</h2> <ol><li>yaml</li></ol> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Namespace
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> production
</code></pre></div><ol start="2"><li>명령어</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl create namespace production
</code></pre></div><ul><li>특정 네임스페이스에 리소스 생성 시 yaml 파일에서 metadata.namespace를 설정하면 됨</li></ul> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>nginx<span class="token punctuation">-</span>pod
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> production
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>nginx<span class="token punctuation">-</span>container
      <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span>latest
      <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
          <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
</code></pre></div><h3 id="하나의-yaml-파일에서-여러-리소스-정의"><a href="#하나의-yaml-파일에서-여러-리소스-정의" class="header-anchor">#</a> 하나의 yaml 파일에서 여러 리소스 정의</h3> <ul><li><code>---</code>를 사용하여 하나의 yaml 파일에서 여러 개의 리소스 정의 가능</li></ul> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Namespace
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> production

<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>nginx<span class="token punctuation">-</span>pod
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> production
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>nginx<span class="token punctuation">-</span>container
      <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span>latest
      <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
          <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
</code></pre></div><ul><li>kubectl get 명령어에 --all-namespaces 옵션을 사용하면 모든 네임스페이스의 리소스 확인 가능</li></ul> <h2 id="네임스페이스-서비스-접근"><a href="#네임스페이스-서비스-접근" class="header-anchor">#</a> 네임스페이스 서비스 접근</h2> <ul><li>서비스 이름 만으로는 같은 네임스페이스 내의 서비스끼리만 접근 가능</li> <li><code>&lt;서비스 이름&gt;.&lt;네임스페이스 이름&gt;.svc</code> 로 다른 네임스페이스의 서비스에도 접근 가능</li></ul> <h2 id="네임스페이스-삭제"><a href="#네임스페이스-삭제" class="header-anchor">#</a> 네임스페이스 삭제</h2> <ul><li>kubectl delete -f &lt;yaml 파일명&gt;</li> <li>kubectl delete namespace</li> <li>로 삭제 가능하지만 해당 네임스페이스에 존재하는 리소스도 모두 삭제되기 때문에 조심해야 함</li></ul> <h2 id="네임스페이스에-종속되는-오브젝트"><a href="#네임스페이스에-종속되는-오브젝트" class="header-anchor">#</a> 네임스페이스에 종속되는 오브젝트</h2> <ul><li><code>kubectl api-resources --namespaced=true</code>로 네임스페이스에 속하는지 확인 가능</li> <li>false로 설정하면 네임스페이스에 속하지 않는 오브젝트들 확인 가능
<ul><li>node, namespace, persistent volume 등</li></ul></li></ul> <h1 id="configmap-secret"><a href="#configmap-secret" class="header-anchor">#</a> Configmap, Secret</h1> <ul><li>애플리케이션의 설정값 지정하려면</li></ul> <ol><li>yaml 파일에 환경 변수 직접 적어놓기 → 상황에 따라서는 환경 변수 값만 다른 동일한 여러 개의 yaml이 존재할 수 있음
<ul><li>ex) 운영 / 개발 환경 분리</li></ul></li> <li><strong>Configmap</strong>, <strong>Secret</strong> 오브젝트 사용
<ul><li>컨피그맵에는 설정값, 시크릿에는 비밀값 저장</li></ul></li></ol> <h2 id="컨피그맵"><a href="#컨피그맵" class="header-anchor">#</a> 컨피그맵</h2> <ul><li>일반적인 설정값 담아 저장</li> <li>네임스페이스에 속함</li></ul> <h3 id="컨피그맵-생성"><a href="#컨피그맵-생성" class="header-anchor">#</a> 컨피그맵 생성</h3> <ol><li>yaml</li></ol> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ConfigMap
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> mysql<span class="token punctuation">-</span>config
<span class="token key atrule">data</span><span class="token punctuation">:</span>
  <span class="token key atrule">MYSQL_ROOT_PASSWORD</span><span class="token punctuation">:</span> test123
  <span class="token key atrule">MYSQL_DATABASE</span><span class="token punctuation">:</span> test
</code></pre></div><ol start="2"><li>명령어 사용</li></ol> <ul><li>kubectl create configmap &lt;컨피그맵 이름&gt; &lt;각종 설정값들&gt;</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token variable"><span class="token variable">`</span>kubectl create configmap mysql-config --from-literal <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span>test123 <span class="token punctuation">\</span>
  --from-literal <span class="token assign-left variable">MYSQL_DATABASE</span><span class="token operator">=</span>test<span class="token variable">`</span></span>
</code></pre></div><h3 id="컨피그맵-확인"><a href="#컨피그맵-확인" class="header-anchor">#</a> 컨피그맵 확인</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>dgh0001@rpi4b:~$ kubectl get cm
NAME                DATA   AGE
kube-root-ca.crt    <span class="token number">1</span>      34d
mysql-config        <span class="token number">2</span>      5s
prometheus-config   <span class="token number">1</span>      28d
web-config          <span class="token number">9</span>      29d

dgh0001@rpi4b:~$ kubectl describe cm mysql-config
Name:         mysql-config
Namespace:    default
Labels:       <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
Annotations:  <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>

Data
<span class="token operator">==</span><span class="token operator">==</span>
MYSQL_DATABASE:
----
<span class="token builtin class-name">test</span>

MYSQL_ROOT_PASSWORD:
----
test123


BinaryData
<span class="token operator">==</span><span class="token operator">==</span>

Events:  <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
</code></pre></div><h3 id="컨피그맵-값-가져오기"><a href="#컨피그맵-값-가져오기" class="header-anchor">#</a> 컨피그맵 값 가져오기</h3> <h3 id="용도"><a href="#용도" class="header-anchor">#</a> 용도</h3> <ol><li>컨피그맵의 값을 컨테이너의 환경 변수로 사용</li></ol> <ul><li>애플리케이션이 시스템 환경 변수로부터 설정값을 가져오는 경우</li> <li>ex) LOG_LEVEL</li></ul> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> mysql<span class="token punctuation">-</span>container
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>container
      <span class="token key atrule">image</span><span class="token punctuation">:</span> mysql<span class="token punctuation">:</span><span class="token number">8.0</span>
      <span class="token key atrule">envFrom</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">configMapRef</span><span class="token punctuation">:</span>
            <span class="token key atrule">name</span><span class="token punctuation">:</span> mysql<span class="token punctuation">-</span>config
</code></pre></div><p><strong>실행 결과</strong></p> <div class="language-sh extra-class"><pre class="language-sh"><code>dgh0001@rpi4b:~$ kubectl <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> mysql-container -- <span class="token function">bash</span>

bash-5.1<span class="token comment"># mysql -u root -p</span>
Enter password:
Welcome to the MySQL monitor.  Commands end with <span class="token punctuation">;</span> or <span class="token punctuation">\</span>g.
Your MySQL connection <span class="token function">id</span> is <span class="token number">10</span>
Server version: <span class="token number">8.0</span>.43 MySQL Community Server - GPL

Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">2000</span>, <span class="token number">2025</span>, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type <span class="token string">'help;'</span> or <span class="token string">'\h'</span> <span class="token keyword">for</span> help. Type <span class="token string">'\c'</span> to <span class="token function">clear</span> the current input statement.

mysql<span class="token operator">&gt;</span> show databases<span class="token punctuation">;</span>
+--------------------+
<span class="token operator">|</span> Database           <span class="token operator">|</span>
+--------------------+
<span class="token operator">|</span> information_schema <span class="token operator">|</span>
<span class="token operator">|</span> mysql              <span class="token operator">|</span>
<span class="token operator">|</span> performance_schema <span class="token operator">|</span>
<span class="token operator">|</span> sys                <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token builtin class-name">test</span>               <span class="token operator">|</span>
+--------------------+
<span class="token number">5</span> rows <span class="token keyword">in</span> <span class="token builtin class-name">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre></div><ol start="2"><li>컨피그맵의 값을 포드 내부의 파일로 마운트해 사용</li></ol> <ul><li>애플리케이션이 특정 파일을 통해 설정값을 읽어오는 경우</li> <li>ex) nginx → nginx.conf를 통해 설정값을 읽어옴</li></ul> <h4 id="deploy-prometheus-yaml"><a href="#deploy-prometheus-yaml" class="header-anchor">#</a> deploy-prometheus.yaml</h4> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> prometheus
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">1</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> prometheus
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> prometheus
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> prometheus
          <span class="token key atrule">image</span><span class="token punctuation">:</span> prom/prometheus
          <span class="token key atrule">args</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>config.file=/etc/prometheus/prometheus.yml
          <span class="token key atrule">ports</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">9090</span>
          <span class="token key atrule">resources</span><span class="token punctuation">:</span>
            <span class="token key atrule">requests</span><span class="token punctuation">:</span>
              <span class="token key atrule">cpu</span><span class="token punctuation">:</span> <span class="token string">&quot;250m&quot;</span>
              <span class="token key atrule">memory</span><span class="token punctuation">:</span> <span class="token string">&quot;256Mi&quot;</span>
            <span class="token key atrule">limits</span><span class="token punctuation">:</span>
              <span class="token key atrule">cpu</span><span class="token punctuation">:</span> <span class="token string">&quot;500m&quot;</span>
              <span class="token key atrule">memory</span><span class="token punctuation">:</span> <span class="token string">&quot;512Mi&quot;</span>
          <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> prometheus<span class="token punctuation">-</span>config <span class="token comment"># volumes에서 정의한 컨피그맵 볼륨 이름</span>
              <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /etc/prometheus <span class="token comment"># 컨피그맵의 데이터가 위치할 경로</span>
      <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> prometheus<span class="token punctuation">-</span>config <span class="token comment"># 컨피그맵 볼륨 이름</span>
          <span class="token key atrule">configMap</span><span class="token punctuation">:</span>
            <span class="token key atrule">name</span><span class="token punctuation">:</span> prometheus<span class="token punctuation">-</span>config <span class="token comment"># 컨피그맵 이름</span>
</code></pre></div><h4 id="config-prometheus-yaml"><a href="#config-prometheus-yaml" class="header-anchor">#</a> config-prometheus.yaml</h4> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ConfigMap
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> prometheus<span class="token punctuation">-</span>config
<span class="token key atrule">data</span><span class="token punctuation">:</span>
  <span class="token key atrule">prometheus.yml</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
    global:
      scrape_interval: 5s
      evaluation_interval: 5s</span>

    <span class="token key atrule">scrape_configs</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">job_name</span><span class="token punctuation">:</span> <span class="token string">&quot;spring-boot-app&quot;</span>
        <span class="token key atrule">metrics_path</span><span class="token punctuation">:</span> <span class="token string">&quot;/actuator/prometheus&quot;</span>
        <span class="token key atrule">static_configs</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">targets</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;svc-clusterip:80&quot;</span> <span class="token punctuation">]</span>
</code></pre></div><ul><li>키:값 에 대해 파일명이 키, 파일 내용이 값으로 만들어짐</li> <li>원하는 특정 값만 가져올 수도 있음</li></ul> <div class="language-yaml extra-class"><pre class="language-yaml"><code>        <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> prometheus<span class="token punctuation">-</span>config
          <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /etc/prometheus
      <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> prometheus<span class="token punctuation">-</span>config
        <span class="token key atrule">configMap</span><span class="token punctuation">:</span>
          <span class="token key atrule">name</span><span class="token punctuation">:</span> prometheus<span class="token punctuation">-</span>config
          <span class="token key atrule">items</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> prometheus.yml <span class="token comment"># prometheus.yml 라는 키에 대응하는 값 가져오기</span>
            <span class="token key atrule">path</span><span class="token punctuation">:</span> new<span class="token punctuation">-</span>proemetheus.yml <span class="token comment"># 최종 파일 이름</span>
</code></pre></div><h3 id="파일로부터-컨피그맵-생성"><a href="#파일로부터-컨피그맵-생성" class="header-anchor">#</a> 파일로부터 컨피그맵 생성</h3> <ul><li>--from-file 옵션 사용</li> <li>자동으로 파일명이 키, 파일 내용이 값이 되어 컨피그맵으로 생성됨</li></ul> <div class="language-yaml extra-class"><pre class="language-yaml"><code>dgh0001@rpi4b<span class="token punctuation">:</span>~$ echo helo world <span class="token punctuation">&gt;</span> index.html
dgh0001@rpi4b<span class="token punctuation">:</span>~$ kubectl create configmap index<span class="token punctuation">-</span>file <span class="token punctuation">-</span><span class="token punctuation">-</span>from<span class="token punctuation">-</span>file index.html
configmap/index<span class="token punctuation">-</span>file created
dgh0001@rpi4b<span class="token punctuation">:</span>~$ kubectl describe configmap index<span class="token punctuation">-</span>file
<span class="token key atrule">Name</span><span class="token punctuation">:</span>         index<span class="token punctuation">-</span>file
<span class="token key atrule">Namespace</span><span class="token punctuation">:</span>    default
<span class="token key atrule">Labels</span><span class="token punctuation">:</span>       &lt;none<span class="token punctuation">&gt;</span>
<span class="token key atrule">Annotations</span><span class="token punctuation">:</span>  &lt;none<span class="token punctuation">&gt;</span>

Data
====
<span class="token key atrule">index.html</span><span class="token punctuation">:</span>
<span class="token punctuation">---</span><span class="token punctuation">-</span>
helo world



BinaryData
====

<span class="token key atrule">Events</span><span class="token punctuation">:</span>  &lt;none<span class="token punctuation">&gt;</span>
</code></pre></div><ul><li>--from-env-file 옵션으로 여러 개의 키-값 형태의 내용으로 구성된 설정파일을 한번에 컨피그맵으로 가져올 수 있음</li></ul> <div class="language-yaml extra-class"><pre class="language-yaml"><code>dgh0001@rpi4b<span class="token punctuation">:</span>~$ cat keyval
mykey1=myval1
mykey2=myval2
mykey3=myval3
dgh0001@rpi4b<span class="token punctuation">:</span>~$ kubectl create configmap from<span class="token punctuation">-</span>envfile <span class="token punctuation">-</span><span class="token punctuation">-</span>from<span class="token punctuation">-</span>env<span class="token punctuation">-</span>file keyval
configmap/from<span class="token punctuation">-</span>envfile created
dgh0001@rpi4b<span class="token punctuation">:</span>~$ kubectl get cm from<span class="token punctuation">-</span>envfile <span class="token punctuation">-</span>o yaml
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">data</span><span class="token punctuation">:</span>
  <span class="token key atrule">mykey1</span><span class="token punctuation">:</span> myval1
  <span class="token key atrule">mykey2</span><span class="token punctuation">:</span> myval2
  <span class="token key atrule">mykey3</span><span class="token punctuation">:</span> myval3
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ConfigMap
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">creationTimestamp</span><span class="token punctuation">:</span> <span class="token string">&quot;2025-10-22T02:49:37Z&quot;</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> from<span class="token punctuation">-</span>envfile
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
  <span class="token key atrule">resourceVersion</span><span class="token punctuation">:</span> <span class="token string">&quot;1265915&quot;</span>
  <span class="token key atrule">uid</span><span class="token punctuation">:</span> dc388e38<span class="token punctuation">-</span>603e<span class="token punctuation">-</span>45fd<span class="token punctuation">-</span>9897<span class="token punctuation">-</span>4be2ea1ef9b8
</code></pre></div><h3 id="쉽게-컨피그맵-yaml-정의하기"><a href="#쉽게-컨피그맵-yaml-정의하기" class="header-anchor">#</a> 쉽게 컨피그맵 yaml 정의하기</h3> <ul><li>--dry-run 과 -o yaml 옵션으로 쉽게 yaml 생성 가능</li></ul> <div class="language-yaml extra-class"><pre class="language-yaml"><code>dgh0001@rpi4b<span class="token punctuation">:</span>~$ kubectl create configmap easy<span class="token punctuation">-</span>configmap \
<span class="token punctuation">&gt;</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>from<span class="token punctuation">-</span>literal mykey=myval <span class="token punctuation">-</span><span class="token punctuation">-</span>dry<span class="token punctuation">-</span>run=client <span class="token punctuation">-</span>o yaml
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">data</span><span class="token punctuation">:</span>
  <span class="token key atrule">mykey</span><span class="token punctuation">:</span> myval
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ConfigMap
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> easy<span class="token punctuation">-</span>configmap
</code></pre></div><h4 id="dry-run"><a href="#dry-run" class="header-anchor">#</a> dry run</h4> <ul><li>특정 작업의 실행 가능 여부 확인</li> <li><code>--dry-run=client</code> 옵션으로 실행 가능 여부를 확인할 수 있으며 실제로 리소스를 생성하진 않음</li></ul> <h2 id="시크릿"><a href="#시크릿" class="header-anchor">#</a> 시크릿</h2> <ul><li>ssh 키, 비밀번호 등과 같은 민감한 정보를 저장하기 위한 용도</li> <li>네임스페이스에 종속</li> <li>컨피그맵처럼 --from-literal, --from-file, --from-env-file 옵션으로 생성 가능</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>dgh0001@rpi4b:~$ kubectl create secret generic <span class="token punctuation">\</span>
<span class="token operator">&gt;</span> my-password --from-literal <span class="token assign-left variable">password</span><span class="token operator">=</span>1q2w3e4r
secret/my-password created

dgh0001@rpi4b:~$ kubectl describe secret my-password
Name:         my-password
Namespace:    default
Labels:       <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
Annotations:  <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>

Type:  Opaque

Data
<span class="token operator">==</span><span class="token operator">==</span>
password:  <span class="token number">8</span> bytes

dgh0001@rpi4b:~$ kubectl get secret my-password <span class="token parameter variable">-o</span> yaml
apiVersion: v1
data:
  password: <span class="token assign-left variable">MXEydzNlNHI</span><span class="token operator">=</span>
kind: Secret
metadata:
  creationTimestamp: <span class="token string">&quot;2025-10-22T03:31:17Z&quot;</span>
  name: my-password
  namespace: default
  resourceVersion: <span class="token string">&quot;1267015&quot;</span>
  uid: 362d7fc4-8400-486a-8914-5f6e1463f6fe
type: Opaque
</code></pre></div><ul><li>시크릿에 값 저장 시 쿠버네티스가 기본적으로 base64로 값 인코딩</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>dgh0001@rpi4b:~$ <span class="token builtin class-name">echo</span> <span class="token assign-left variable">MXEydzNlNHI</span><span class="token operator">=</span> <span class="token operator">|</span> base64 <span class="token parameter variable">-d</span>
1q2w3e4r
</code></pre></div><ul><li>디코딩하면 원래 값 나오는 모습</li></ul> <h3 id="사용-방법"><a href="#사용-방법" class="header-anchor">#</a> 사용 방법</h3> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token punctuation">...</span>
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
    <span class="token key atrule">envFrom</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">secretRef</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>password

<span class="token punctuation">---</span>

      <span class="token key atrule">env</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> PASSWORD
      <span class="token key atrule">valueFrom</span><span class="token punctuation">:</span>
        <span class="token key atrule">secretKeyRef</span><span class="token punctuation">:</span>
          <span class="token key atrule">name</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>password
          <span class="token key atrule">key</span><span class="token punctuation">:</span> password

<span class="token punctuation">---</span>

      <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> secret<span class="token punctuation">-</span>volume
        <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /etc/config
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> secret<span class="token punctuation">-</span>volume
    <span class="token key atrule">secret</span><span class="token punctuation">:</span>
      <span class="token key atrule">secretName</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>password

<span class="token punctuation">---</span>

      <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> secret<span class="token punctuation">-</span>volume
        <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /etc/config
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> secret<span class="token punctuation">-</span>volume
    <span class="token key atrule">secret</span><span class="token punctuation">:</span>
      <span class="token key atrule">secretName</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>password <span class="token comment"># 시크릿 이름</span>
      <span class="token key atrule">items</span><span class="token punctuation">:</span> <span class="token comment"># 시크릿에서 가져올 키-값 목록</span>
      <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> password <span class="token comment"># 키</span>
        <span class="token key atrule">path</span><span class="token punctuation">:</span> new<span class="token punctuation">-</span>password <span class="token comment"># 최종 파일은 /etc/config/new-password 가 됨</span>
</code></pre></div><h3 id="시크릿-종류"><a href="#시크릿-종류" class="header-anchor">#</a> 시크릿 종류</h3> <ol><li>Opaque</li></ol> <ul><li>별도로 종류를 명시하지 않으면 자동으로 설정되는 타입</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>dgh0001@rpi4b:~$ kubectl create secret generic <span class="token punctuation">\</span>
<span class="token operator">&gt;</span> my-password --from-literal <span class="token assign-left variable">password</span><span class="token operator">=</span>1q2w3e4r
secret/my-password created
</code></pre></div><ul><li>여기서 사용한 generic이 Opaque 타입</li></ul> <ol start="2"><li>docker-registry</li></ol> <ul><li>프라이빗 레지스트리 접근 시 사용</li> <li>ex) 사설 레지스트리, 도커 허브, GCR, ECR 등을 사용하는 경우</li></ul> <ol start="3"><li>tls</li></ol> <ul><li>tls 연결에 사용되는 공개키, 비밀키 등을 쿠버네티스에 자체적으로 저장 가능</li></ul> <div class="language-yaml extra-class"><pre class="language-yaml"><code>dgh0001@rpi4b<span class="token punctuation">:</span>~$ openssl req <span class="token punctuation">-</span>new <span class="token punctuation">-</span>newkey rsa<span class="token punctuation">:</span>4096 <span class="token punctuation">-</span>days 365 <span class="token punctuation">-</span>nodes \
<span class="token punctuation">&gt;</span> <span class="token punctuation">-</span>x509 <span class="token punctuation">-</span>subj &quot;/CN=example.com&quot; <span class="token punctuation">-</span>keyout cert.key <span class="token punctuation">-</span>out cert.crt
<span class="token punctuation">...</span>

dgh0001@rpi4b<span class="token punctuation">:</span>~$ ls cert.*
cert.crt  cert.key

dgh0001@rpi4b<span class="token punctuation">:</span>~$ kubectl create secret tls my<span class="token punctuation">-</span>tls<span class="token punctuation">-</span>secret \
<span class="token punctuation">&gt;</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>cert cert.crt <span class="token punctuation">-</span><span class="token punctuation">-</span>key cert.key
secret/my<span class="token punctuation">-</span>tls<span class="token punctuation">-</span>secret created
dgh0001@rpi4b<span class="token punctuation">:</span>~$ kubectl get secrets my<span class="token punctuation">-</span>tls<span class="token punctuation">-</span>secret <span class="token punctuation">-</span>o yaml
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">data</span><span class="token punctuation">:</span>
  <span class="token key atrule">tls.crt</span><span class="token punctuation">:</span> LS0tLS1CRUdJ<span class="token punctuation">...</span>
  <span class="token key atrule">tls.key</span><span class="token punctuation">:</span> LS0tLS1CRUdJ<span class="token punctuation">...</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Secret
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">creationTimestamp</span><span class="token punctuation">:</span> <span class="token string">&quot;2025-10-22T03:49:23Z&quot;</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>tls<span class="token punctuation">-</span>secret
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
  <span class="token key atrule">resourceVersion</span><span class="token punctuation">:</span> <span class="token string">&quot;1267502&quot;</span>
  <span class="token key atrule">uid</span><span class="token punctuation">:</span> b0fa1bfa<span class="token punctuation">-</span>3faf<span class="token punctuation">-</span>4ad0<span class="token punctuation">-</span>8cbb<span class="token punctuation">-</span>8ff78c3dad27
<span class="token key atrule">type</span><span class="token punctuation">:</span> kubernetes.io/tls
dgh0001@rpi4b<span class="token punctuation">:</span>~$
</code></pre></div><h1 id="ingress"><a href="#ingress" class="header-anchor">#</a> Ingress</h1> <ul><li>외부에서 오는 요청을 어떻게 처리할 것인지 네트워크 7계층 레벨(응용 계층)에서 정의하는 쿠버네티스 오브젝트</li> <li>외부 요청 라우팅, 가상 호스트 기반 요청 처리, ssl/tls 보안 연결 처리 등에 사용</li></ul> <h2 id="인그레스-사용하는-이유"><a href="#인그레스-사용하는-이유" class="header-anchor">#</a> 인그레스 사용하는 이유</h2> <ul><li>디플로이먼트에 레플리카 3개 두고 nodePort로 외부 노출하는 경우 → 3개 포드 일일히 다 ssl/tls 보안 설정 해줘야 함</li> <li>인그레스 사용하면 앞단에 인그레스 오브젝트 하나 두고 한번만 보안 설정해주면 됨</li> <li>즉, 하나의 설정 지점에서만 처리 규칙을 정의해주면 됨</li></ul> <h2 id="인그레스-생성"><a href="#인그레스-생성" class="header-anchor">#</a> 인그레스 생성</h2> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> networking.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Ingress
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> ingress<span class="token punctuation">-</span>knuchat<span class="token punctuation">-</span>bot
  <span class="token key atrule">annotations</span><span class="token punctuation">:</span>
    <span class="token key atrule">nginx.ingress.kubernetes.io/ssl-redirect</span><span class="token punctuation">:</span> <span class="token string">&quot;true&quot;</span> <span class="token comment"># http 요청을 자동으로 https로 리다이렉트</span>
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">ingressClassName</span><span class="token punctuation">:</span> nginx
  <span class="token key atrule">tls</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> knu<span class="token punctuation">-</span>chatbot.o<span class="token punctuation">-</span>r.kr
      <span class="token key atrule">secretName</span><span class="token punctuation">:</span> knu<span class="token punctuation">-</span>chatbot<span class="token punctuation">-</span>tls
  <span class="token key atrule">rules</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> knu<span class="token punctuation">-</span>chatbot.o<span class="token punctuation">-</span>r.kr
      <span class="token key atrule">http</span><span class="token punctuation">:</span>
        <span class="token key atrule">paths</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span> /
            <span class="token key atrule">pathType</span><span class="token punctuation">:</span> Prefix
            <span class="token key atrule">backend</span><span class="token punctuation">:</span>
              <span class="token key atrule">service</span><span class="token punctuation">:</span>
                <span class="token key atrule">name</span><span class="token punctuation">:</span> svc<span class="token punctuation">-</span>clusterip
                <span class="token key atrule">port</span><span class="token punctuation">:</span>
                  <span class="token key atrule">number</span><span class="token punctuation">:</span> <span class="token number">80</span>
</code></pre></div><h2 id="ingress-controller"><a href="#ingress-controller" class="header-anchor">#</a> Ingress Controller</h2> <ul><li>실제 외부 요청을 받아들이는 인그레스 컨트롤러에 인그레스 규칙을 로드해 사용 가능
<img src="https://blogfiles.pstatic.net/MjAxOTA0MDFfMzEg/MDAxNTU0MDk0MzE3ODQw.bAWecmPjZ7FdiGK1BuTnSe7D9EaYK2TIJgDwB8ENczkg.MZJ_mFOHBM6RkOIOZMlYhH9uQ_xBQOfSNQRcq7OW14cg.PNG.alice_k106/%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7_2019-04-01_%EC%98%A4%ED%9B%84_1.51.46.png?type=w2" alt=""></li> <li>근데 인그레스 컨트롤러를 설치해도 nginx 웹 서버를 외부로 노출하기 위한 서비스를 생성해주지는 않음</li> <li>정리하자면 인그레스 컨트롤러 설치 + 인그레스 규칙 정의 + 인그레스 컨트롤러를 외부로 노출하기 위한 서비스 생성</li></ul> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> ingress<span class="token punctuation">-</span>nginx
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> ingress<span class="token punctuation">-</span>nginx
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">type</span><span class="token punctuation">:</span> NodePort
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app.kubernetes.io/name</span><span class="token punctuation">:</span> ingress<span class="token punctuation">-</span>nginx
    <span class="token key atrule">app.kubernetes.io/part-of</span><span class="token punctuation">:</span> ingress<span class="token punctuation">-</span>nginx
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> http
      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
      <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> http
      <span class="token key atrule">nodePort</span><span class="token punctuation">:</span> <span class="token number">32080</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> https
      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">443</span>
      <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> https
      <span class="token key atrule">nodePort</span><span class="token punctuation">:</span> <span class="token number">32443</span>
</code></pre></div><p><img src="https://user-images.githubusercontent.com/47745785/148160220-c349e51b-2b0f-4e73-9cac-9e6739d603eb.png" alt=""></p> <h2 id="인그레스-세부-기능-annotation"><a href="#인그레스-세부-기능-annotation" class="header-anchor">#</a> 인그레스 세부 기능 - annotation</h2> <ul><li>위에서 사용한 <code>nginx.ingress.kubernetes.io/ssl-redirect</code> 옵션처럼 annotation을 사용하여 다양한 옵션 적용 가능</li> <li>ex</li></ul> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> networking.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Ingress
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> ingress<span class="token punctuation">-</span>knuchat<span class="token punctuation">-</span>bot
  <span class="token key atrule">annotations</span><span class="token punctuation">:</span>
    <span class="token key atrule">nginx.ingress.kubernetes.io/ssl-redirect</span><span class="token punctuation">:</span> <span class="token string">&quot;true&quot;</span> <span class="token comment"># http 요청을 자동으로 https로 리다이렉트</span>
    <span class="token key atrule">nginx.ingress.kubernetes.io/rewrite-target</span><span class="token punctuation">:</span> / <span class="token comment"># /test 경로로 들어온 요청은 /로 전달</span>
      <span class="token key atrule">paths</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span> /test
    <span class="token key atrule">kubernetes.io/ingress.class</span><span class="token punctuation">:</span> <span class="token string">&quot;nginx&quot;</span> <span class="token comment"># 해당 인그레스 규칙을 어떤 인그레스 컨트롤러에 적용할 것인지</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/TIL/Kubernetes/1.-포드,-레플리카-셋,-디플로이먼트,-서비스.html" class="prev">
        1.포드, 레플리카 셋, 디플로이먼트, 서비스
      </a></span> <span class="next"><a href="/TIL/Kubernetes/3.-pv와-pvc.html">
        3. PV와 PVC
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/TIL/assets/js/app.0dbe4d60.js" defer></script><script src="/TIL/assets/js/2.188c950f.js" defer></script><script src="/TIL/assets/js/1.a1e51968.js" defer></script><script src="/TIL/assets/js/65.cce0c2b8.js" defer></script>
  </body>
</html>
