(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{382:function(t,s,a){"use strict";a.r(s);var n=a(28),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"_7-도메인-서비스"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-도메인-서비스"}},[t._v("#")]),t._v(" 7. 도메인 서비스")]),t._v(" "),s("h2",{attrs:{id:"_7-1-여러-애그리거트가-필요한-기능"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-여러-애그리거트가-필요한-기능"}},[t._v("#")]),t._v(" 7.1 여러 애그리거트가 필요한 기능")]),t._v(" "),s("ul",[s("li",[t._v("한 애그리거트로는 표현하기 애매한 부분이 생길 수 있음")]),t._v(" "),s("li",[t._v("ex) 총 주문 금액(상품, 주문, 할인 쿠폰, 회원 할인 등...)")]),t._v(" "),s("li",[t._v("이렇게 애매한 도메인 기능을 특정 애그리거트에 억지로 구현하면 안됨")])]),t._v(" "),s("p",[t._v("→ 도메인 기능을 별도 서비스로 구현")]),t._v(" "),s("h2",{attrs:{id:"_7-2-도메인-서비스"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-도메인-서비스"}},[t._v("#")]),t._v(" 7.2 도메인 서비스")]),t._v(" "),s("p",[t._v("다음과 같은 상황에 도메인 서비스 사용")]),t._v(" "),s("ul",[s("li",[t._v("계산 로직 : 여러 애그리거트가 필요한 계산 로직, 한 애그리거트에 넣기에는 다소 복잡한 계산 로직")]),t._v(" "),s("li",[t._v("외부 시스템 연동이 필요한 도메인 로직 : 구현하기 위해 타 시스템을 사용해야 하는 도메인 로직")])]),t._v(" "),s("h3",{attrs:{id:"_7-2-1-계산-로직과-도메인-서비스"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-1-계산-로직과-도메인-서비스"}},[t._v("#")]),t._v(" 7.2.1 계산 로직과 도메인 서비스")]),t._v(" "),s("ul",[s("li",[t._v("응용 영역의 서비스 → 응용 로직")]),t._v(" "),s("li",[t._v("도메인 서비스 → 도메인 로직")]),t._v(" "),s("li",[t._v("도메인 서비스는 상태 없이 로직만 구현")]),t._v(" "),s("li",[t._v("ex) 할인 금액 계산 로직 도메인 서비스")])]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DiscountCalculationService")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Money")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("calculateDiscountAmounts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" \n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("OrderLine")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" orderLines"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Coupon")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" coupons"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MemberGrade")]),t._v(" grade"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        \n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Money")]),t._v(" couponDiscount "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" coupons"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stream")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("coupon "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("calculateDiscount")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("coupon"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("reduce")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Money")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" v2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" v1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Money")]),t._v(" membershipDiscount "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("calculateDiscount")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("grade"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" couponDiscount"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("membershipDiscount"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Money")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("calculateDiscount")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Coupon")]),t._v(" coupon"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 쿠폰에 따른 할인 금액 계산 로직")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Money")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("calculateDiscount")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MemberGrade")]),t._v(" grade"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 회원 등급에 따른 할인 금액 계산 로직")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[t._v("도메인의 의미가 드러나는 용어를 타입과 메서드 이름으로 가짐")]),t._v(" "),s("li",[t._v("해당 도메인 서비스를 애그리거트 객체에 전달")])]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("calculateAmounts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DiscountCalculationService")]),t._v(" disCalSvc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MemberGrade")]),t._v(" grade"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Money")]),t._v(" totalAmounts "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getTotalAmounts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Money")]),t._v(" discountAmounts "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" disCalSvc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("calculateDiscountAmounts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("orderLines"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("coupons"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" grade"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("paymentAmounts "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" totalAmounts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("minus")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("discountAmounts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),s("h4",{attrs:{id:"도메인-서비스-객체를-애그리거트에-주입해도-될까"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#도메인-서비스-객체를-애그리거트에-주입해도-될까"}},[t._v("#")]),t._v(" 도메인 서비스 객체를 애그리거트에 주입해도 될까?")]),t._v(" "),s("ul",[s("li",[t._v("필자는 추천하지 않는 방법")]),t._v(" "),s("li",[t._v("도메인 객체에서 필드는 데이터를 담는 기능인 중요한 구성요소")]),t._v(" "),s("li",[t._v("그런데 도메인 서비스는 데이터 자체와는 관련이 없음 + 저장 대상도 아님")]),t._v(" "),s("li",[t._v("굳이 의존 주입할 이유가 없음")])]),t._v(" "),s("p",[t._v("반대로 도메인 서비스를 이용할 떄 애그리거트를 전달하기도 함")]),t._v(" "),s("p",[s("strong",[t._v("중요한 건, 도메인 서비스는 도메인 로직만을 수행하지, 응용 로직(e.g. 트랜잭션 처리, 애그리거트의 상태 변경)을 수행해서는 안됨")])]),t._v(" "),s("h3",{attrs:{id:"_7-2-2-외부-시스템-연동과-도메인-서비스"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-2-외부-시스템-연동과-도메인-서비스"}},[t._v("#")]),t._v(" 7.2.2 외부 시스템 연동과 도메인 서비스")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SurveyPermissionChecker")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("hasUserCreationPermission")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" userId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[t._v("외부 시스템과 HTTP로 소통 → 도메인 입장에서는 도메인 로직으로 볼 수 있음")]),t._v(" "),s("li",[t._v("인터페이스(도메인)와 구현체(인프라)로 구현")])]),t._v(" "),s("h3",{attrs:{id:"_7-2-3-도메인-서비스의-패키지-위치"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-3-도메인-서비스의-패키지-위치"}},[t._v("#")]),t._v(" 7.2.3 도메인 서비스의 패키지 위치")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://blog.kakaocdn.net/dna/boXlQV/btsDUKTw5HT/AAAAAAAAAAAAAAAAAAAAAAw3zRiNwvw-y5l4_GXj1xOwlwdsTZIONmBaJ3JPugZ_/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1756652399&allow_ip=&allow_referer=&signature=LDrYt%2FSsBT1cKWrdh8VTZoJoIgw%3D",alt:""}})]),t._v(" "),s("ul",[s("li",[t._v("도메인 서비스의 개수가 많거나 다른 구성요소와 명시적으로 구분하고 싶다면 domain 패키지 밑에 "),s("code",[t._v("domain.model")]),t._v(", "),s("code",[t._v("domain.service")]),t._v(", "),s("code",[t._v("domain.repository")]),t._v(" 등으로 구분하여 위치시켜도 됨")])]),t._v(" "),s("h3",{attrs:{id:"_7-2-4-도메인-서비스의-인터페이스와-클래스"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-4-도메인-서비스의-인터페이스와-클래스"}},[t._v("#")]),t._v(" 7.2.4 도메인 서비스의 인터페이스와 클래스")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://velog.velcdn.com/images/aoqlsdl/post/bcab4a5d-851d-492b-b32c-ea0b62b75764/image.png",alt:""}})]),t._v(" "),s("ul",[s("li",[t._v("도메인 서비스의 구현이 특정 기술에 의존하면 인터페이스 + 구현체 (추상화)")]),t._v(" "),s("li",[t._v("도메인 영역이 특정 구현에 종속되는 것을 방지할 수 있음")])])])}),[],!1,null,null,null);s.default=e.exports}}]);