(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{397:function(t,s,a){"use strict";a.r(s);var e=a(28),n=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"_5-커스텀-리소스-컨트롤러-잡-데몬셋-스테이트풀셋"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-커스텀-리소스-컨트롤러-잡-데몬셋-스테이트풀셋"}},[t._v("#")]),t._v(" 5. 커스텀 리소스, 컨트롤러, 잡, 데몬셋, 스테이트풀셋")]),t._v(" "),s("h2",{attrs:{id:"커스텀-리소스"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#커스텀-리소스"}},[t._v("#")]),t._v(" 커스텀 리소스")]),t._v(" "),s("ul",[s("li",[t._v("쿠버네티스에서 자체적으로 제공하는 리소스 외에 직접 정의해 사용할 수 있는 리소스")]),t._v(" "),s("li",[t._v("커스텀 리소스를 제대로 사용하려면 컨트롤러라는 별도 컴포넌트를 이해하고 구현할 수 있어야 함")])]),t._v(" "),s("blockquote",[s("h2",{attrs:{id:"쿠버네티스-컨트롤러"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#쿠버네티스-컨트롤러"}},[t._v("#")]),t._v(" 쿠버네티스 컨트롤러")]),t._v(" "),s("ul",[s("li",[t._v("도커와 쿠버네티스는 리소스를 생성하는 방식이 다름\n"),s("ul",[s("li",[t._v("도커 : "),s("code",[t._v("docker run")]),t._v("처럼 특정 명령을 처리하는 주체와 통신해 그 작업을 수행하고 그 결괏값을 돌려 받는 방식 ("),s("strong",[t._v("명령형")]),t._v(")")]),t._v(" "),s("li",[t._v("쿠버네티스 : "),s("code",[t._v("kubectl apply")]),t._v("처럼 최종적으로 도달해야 하는 상태(바람직한 상태, Desired State)를 정의한 뒤, 현재 상태가 바람직한 상태와 다를 경우 이를 일치시키는 방법 ("),s("strong",[t._v("선언형")]),t._v(")")])])]),t._v(" "),s("li",[t._v("선언형 사용 시 최종적으로 완성되어야 하는 상태가 되기 위해 어떠한 동작을 하는지는 쿠버네티스에서 "),s("strong",[t._v("컨트롤러")]),t._v("가 내부적으로 결정")]),t._v(" "),s("li",[t._v("이때 상태는 "),s("strong",[t._v("etcd")]),t._v("에 저장되어 있으며, 컨트롤러는 쿠버네티스 API 서버의 "),s("strong",[t._v("Watch API")]),t._v("를 통해 etcd에 저장된 상태를 받아와 동작 수행\n"),s("ul",[s("li",[s("strong",[t._v("etcd")]),t._v(" : 클러스터 상태와 설정을 저장하는 오픈소스 분산 키-값 저장소")]),t._v(" "),s("li",[s("strong",[t._v("Watch API")]),t._v(" : 리소스의 생성, 수정, 삭제 같은 변경 이벤트를 클라이언트나 다른 컨트롤러에게 실시간으로 알려주는 기능")])])])])]),t._v(" "),s("ul",[s("li",[t._v("커스텀 리소스는 직접 정의해 사용할 수 있는 사용자 정의 리소스")]),t._v(" "),s("li",[t._v("디플로이먼트, 서비스 등의 오브젝트의 묶음을 커스텀 리소스로 추상화 함으로써 쿠버네티스 리소스를 묶어 놓은 패키지처럼 사용할 수도 있음\n"),s("img",{attrs:{src:"https://velog.velcdn.com/images/temporary23571/post/1f0cb2bb-902f-45a9-b41e-c2a216f993fe/image.PNG",alt:""}})]),t._v(" "),s("li",[t._v("위 그림과 같이 여러 리소스를 한번에 생성할 수 있고, 각 리소스의 생애 주기를 쉽게 관리 가능")]),t._v(" "),s("li",[t._v("많은 관리의 복잡성을 줄일 수 있고, 오브젝트를 원하는 대로 확장해 사용 가능")])]),t._v(" "),s("h3",{attrs:{id:"custom-resource-definition"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#custom-resource-definition"}},[t._v("#")]),t._v(" Custom Resource Definition")]),t._v(" "),s("ul",[s("li",[t._v("crd라 하며 "),s("code",[t._v("kubectl get crd")]),t._v(" 명령어를 통해 목록 확인 가능")]),t._v(" "),s("li",[t._v("커스텀 리소스를 정의하는 역할, crd 자체가 커스텀 리소스를 의미하는건 아님")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" apiextensions.k8s.io/v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" CustomResourceDefinition\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" managedredises.cloud.com "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# CRD 이름")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("group")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" cloud.com\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("names")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# CR 이름")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ManagedRedis\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("plural")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" managedredises\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("shortNames")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" mr\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("singular")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" managedredis\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("scope")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Namespaced "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 네임스페이스에 속하는지 여부")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("versions")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("openAPIV3Schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("properties")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("properties")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("description")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" The image of Redis cluster\n                "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" string\n              "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("replica")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("description")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" The number of Redis replica\n                "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" integer\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("required")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 반드시 포함되어야 하는 spec 정의 부분")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" replica\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" image\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" object\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("status")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 해당 CRD를 관리하는 컨트롤러에 의해 채워지는 현재 상태 정보")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("properties")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("message")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 현재 상태 설명")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("description")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" A descriptive message about the cluster's status.\n                "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" string\n              "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("phase")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 현재 상태")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("description")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" The current phase of the Redis cluster (e.g."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Pending"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                  Running"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Failed).\n                "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" string\n              "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("primary_endpoint")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 쓰기 주소")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("description")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" The Redis cluster's primary connection endpoint for writing.\n                "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" string\n              "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("secondary_endpoint")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 읽기 주소")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("description")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" The Redis cluster's secondary connection endpoint for\n                  reading.\n                "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" string\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" object\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("x-kubernetes-preserve-unknown-fields")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# CRD 스키마에서 알 수 없는(정의되지 않은) 필드를 허용")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" object\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("subresources")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("status")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[t._v("위와 같이 crd를 정의하는 것 외에 특정 동작을 수행하는 컨트롤러를 정의해줘야 함\n"),s("img",{attrs:{src:"https://mblogthumb-phinf.pstatic.net/MjAxOTA3MDdfMjY2/MDAxNTYyNDkzNzIyMTcx.Sp9daHGfe5zryLIeKWA-GD4Lo4VSn8qJubjA8RT-RLQg.PVs-5vLc2zmt_Pd0rk37FsOjX7LTzqjFoo0yNDUFJxog.JPEG.alice_k106/crd.jpg?type=w420",alt:""}})]),t._v(" "),s("li",[t._v("컨트롤러는 Watch API를 통해 새로운 CR이 생성되었다는 것을 갑지하고, CR이 원하는 바람직한 상태가 되도록 특정 동작 수행")]),t._v(" "),s("li",[t._v("이러한 바람직한 상태가 되도록 특정 동작을 수행하는 것을 "),s("strong",[t._v("Reconcile")]),t._v("이라 부름")]),t._v(" "),s("li",[t._v("이렇게 일련의 동작을 통해 CRD를 사용할 수 있도록 컨트롤러를 구현하는 방법을 오퍼레이터(Operator) 패턴이라 부름")])]),t._v(" "),s("h2",{attrs:{id:"잡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#잡"}},[t._v("#")]),t._v(" 잡")]),t._v(" "),s("ul",[s("li",[t._v("잡(Job)은 특정 동작을 수행하고 종료해야 하는 작업을 위한 오브젝트")]),t._v(" "),s("li",[t._v("잡에서 원하는 최종 상태는 "),s("strong",[t._v("포드가 실행되어 정상적으로 종료되는 것")])])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" batch/v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Job\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" job"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("hello"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("world\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restartPolicy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Never "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# OnFailure 설정 시 spec.backoffLimit으로 재시도 횟수 설정 가능 (기본적으로는 6번)")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("containers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" busybox\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("args")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sh"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-c"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"echo Hello, World && exit 0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" job"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("hello"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("world\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" kubectl apply "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" job-hello-world.yaml\njob.batch/job-hello-world created\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" kubectl get pods\nNAME                    READY   STATUS      RESTARTS   AGE\njob-hello-world-cj7lv   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("/1     Completed   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          12s\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" kubectl get "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("jobs")]),t._v("\nNAME              STATUS     COMPLETIONS   DURATION   AGE\njob-hello-world   Complete   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/1           8s         9s\n")])])]),s("ul",[s("li",[t._v("한 번 수행하고 종료되는 배치 작업에 사용됨")]),t._v(" "),s("li",[t._v("잡은 동시성을 엄격하게 보장해야 하는 병렬 처리를 위해 사용하는 것이 아님")]),t._v(" "),s("li",[t._v("restartPolicy에 의해 재시작될 수도 있어서 잡이 처리하는 작업은 멱등성을 가져야 함\n"),s("ul",[s("li",[s("strong",[t._v("멱등성")]),t._v(" : 첫 번째 수행을 한 뒤 여러 차례 적용해도 결과를 변경시키지 않는 작업 또는 기능의 속성")])])])]),t._v(" "),s("h3",{attrs:{id:"잡의-세부옵션"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#잡의-세부옵션"}},[t._v("#")]),t._v(" 잡의 세부옵션")]),t._v(" "),s("ul",[s("li",[t._v("spec.completions : 잡이 성공했다고 여겨지려면 몇 개의 포드가 성공해야 하는지")]),t._v(" "),s("li",[t._v("spec.parallelism : 동시에 생성될 포드의 개수 (기본값은 1)")]),t._v(" "),s("li",[t._v("spec.activeDeadlineSeconds : 포드가 실행될 수 있는 최대 시간. 더 오래 실행될 경우 강제로 종료되며, 잡은 실패함")])]),t._v(" "),s("h3",{attrs:{id:"크론잡으로-잡을-주기적으로-실행하기"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#크론잡으로-잡을-주기적으로-실행하기"}},[t._v("#")]),t._v(" 크론잡으로 잡을 주기적으로 실행하기")]),t._v(" "),s("ul",[s("li",[t._v("잡을 주기적으로 실행하는 쿠버네티스 오브젝트")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" batch/v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" CronJob\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" cronjob"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("ex\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("schedule")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*/1 * * * *"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("jobTemplate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restartPolicy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Never\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("containers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" busybox\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("args")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sh"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-c"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"echo Hello, World && exit 0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" job"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("hello"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("world\n")])])]),s("ul",[s("li",[t._v("리눅스의 크론 스케줄 방법을 사용하여 정의 가능")])]),t._v(" "),s("h2",{attrs:{id:"데몬셋"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#데몬셋"}},[t._v("#")]),t._v(" 데몬셋")]),t._v(" "),s("ul",[s("li",[t._v("데몬셋(DaemonSet)은 쿠버네티스의 모든 노드에 동일한 포드를 하나씩 생성하는 오브젝트")]),t._v(" "),s("li",[t._v("로깅, 모니터링, 네트워킹 등을 위한 에이전트를 각 노드에 생성해야 할 때 사용")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" kubectl get daemonsets "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-n")]),t._v(" kube-system\nNAME         DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR            AGE\nkube-proxy   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("         "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("         "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("            "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("           kubernetes.io/os"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("linux   69d\n")])])]),s("ul",[s("li",[t._v("쿠버네티스 네트워킹을 위한 kube-proxy 컴포넌트 등이 데몬셋으로 실행되고 있음")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" apps/v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" DaemonSet\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" daemonset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("example\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("selector")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("matchLabels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("daemonset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("example "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 포드를 생성하기 위한 셀렉터")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("labels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("daemonset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("example "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 포드 라벨")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("containers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" daemonset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("example\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" busybox\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("args")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tail"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-f"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/dev/null"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("ul",[s("li",[t._v("특정 노드에만 데몬셋의 포드를 생성하고 싶다면 nodeSelector나 Node Affinity를 포드에 적용할 수도 있음")])]),t._v(" "),s("h2",{attrs:{id:"스테이트풀셋"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#스테이트풀셋"}},[t._v("#")]),t._v(" 스테이트풀셋")]),t._v(" "),s("ul",[s("li",[t._v("쿠버네티스에서 MSA 구조로 동작하는 애플리케이션은 대부분 Stateless인 경우가 많음")]),t._v(" "),s("li",[t._v("데이터베이스처럼 Stateful한 애플리케이션은 스테이트풀셋(StatefulSet)으로 관리 가능\n"),s("img",{attrs:{src:"https://blog.kakaocdn.net/dna/1UODm/btq74auZKMp/AAAAAAAAAAAAAAAAAAAAAHiZAJi0KrWFATpI1f1YDRODK3LT0g7XGcRnZBL8GqFB/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=60VeFuKpkJCJ8Ua2Vax6JsMlsBw%3D",alt:""}})])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" apps/v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" StatefulSet\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" statefulset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("example\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("serviceName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" statefulset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("selector")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("matchLabels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" statefulset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("example\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("replicas")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("labels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" statefulset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("example\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("containers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" statefulset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("example\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" alicek106/rr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("test"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("echo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("hostname\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("containerPort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" web\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("---")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Service\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" statefulset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("port")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" web\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("clusterIP")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" None\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("selector")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" statefulset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("example\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" kubectl apply "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" statefulset-example.yaml\nstatefulset.apps/statefulset-example created\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" kubectl get sts\nNAME                  READY   AGE\nstatefulset-example   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("/3     18s\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" kubectl get pods\nNAME                    READY   STATUS      RESTARTS   AGE\njob-hello-world-cj7lv   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("/1     Completed   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          54m\nstatefulset-example-0   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/1     Running     "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          25s\nstatefulset-example-1   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/1     Running     "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          13s\nstatefulset-example-2   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/1     Running     "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          12s\n")])])]),s("ul",[s("li",[t._v("포드에 랜덤한 이름이 아닌 고유한 이름이 붙혀짐")]),t._v(" "),s("li",[t._v("spec.ServiceName을 정의하는 이유는 랜덤 포드가 아닌 개별 포드에 요청을 전달하기 위함\n"),s("img",{attrs:{src:"https://blog.kakaocdn.net/dna/cJlbav/btq75DJQdWf/AAAAAAAAAAAAAAAAAAAAAFinXS3bvaaks7KG6bMaHMuX8wVRSGRyRYXphahoeGPr/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=VXbWxJ2zfxgzfek4dKpYBNkYVCc%3D",alt:""}})]),t._v(" "),s("li",[t._v("각 포드는 고유하게 식별되어야 하며, 랜덤한 포드로 전달되는 동작은 스테이트풀셋이 원하는 동작이 아님")]),t._v(" "),s("li",[t._v("이때 일반적인 서비스가 아닌 헤드리스 서비스 사용 가능")])]),t._v(" "),s("h3",{attrs:{id:"헤드리스-서비스"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#헤드리스-서비스"}},[t._v("#")]),t._v(" 헤드리스 서비스")]),t._v(" "),s("ul",[s("li",[t._v("clusterIP의 항목이 None으로 되어 있음 → 헤드리스 서비스 의미")]),t._v(" "),s("li",[t._v("로드 밸런싱을 수행하지 않고, 개별 파드에 직접 접근할 수 있는 경로를 제공하는 방식")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" kubectl run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-i")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--tty")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--image")]),t._v(" busybox:1.28 debug "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--restart")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Never "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--rm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("nslookup")]),t._v(" statefulset-service\nServer:    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.96")]),t._v(".0.10\nAddress "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.96")]),t._v(".0.10 kube-dns.kube-system.svc.cluster.local\n\nName:      statefulset-service\nAddress "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.1")]),t._v(".1.186 statefulset-example-0.statefulset-service.default.svc.cluster.local\nAddress "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(": "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.1")]),t._v(".1.188 statefulset-example-2.statefulset-service.default.svc.cluster.local\nAddress "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(": "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.1")]),t._v(".1.187 statefulset-example-1.statefulset-service.default.svc.cluster.local\n")])])]),s("ul",[s("li",[t._v("위와 같이 "),s("code",[t._v("<포드의 이름>.<서비스 이름>")]),t._v("을 통해서도 포드에 접근 가능")]),t._v(" "),s("li",[t._v("포드의 데이터는 일반적으로 휘발성이기 때문에 스테이트풀셋에 PV를 마운트해서 데이터를 보존하는 것이 일반적임")]),t._v(" "),s("li",[t._v("PVC를 정의해두고 다이나믹 프로비저닝으로 PV 자동 생성 방식도 사용 가능")])])])}),[],!1,null,null,null);s.default=n.exports}}]);